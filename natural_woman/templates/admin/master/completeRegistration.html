
{% extends "admin/master/emptyBase.html" %}

{% block content %}

<script type="text/javascript">
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
// DO NOT INCLUDE THESSE FUNCTIONS .... THEY ARE DUPLICATES

function generateErrorWindow(messages)
{
    html = "";
    html += "<div class='su-center su-width30'>";
    html += "<div class='su-general'>";
    html += "<div class='su-closer'><a href=\"javascript: closeError();\"><i class='fas fa-window-close su-err'></i></a></div>";
    html += "<div class='su-error-header su-neg25'><i class='fas fa-exclamation-triangle'></i> <span id='su-error-header'>Error</span></div>";
    html += "<div class='err0' id='err0'>" + messages[0] + "</div>";
    html += "<div class='err1' id='err1'>" + messages[1] + "</div>";
    html += "</div>";
    html += "</div>";
    $("#su-editor-builder").html(html);
    $("#su-editor-builder").hide();
    $("#su-editor-builder").removeClass('hidden');
    $("#su-editor-builder").fadeIn(600);
}

function closeError()
{
    $("#su-editor-builder").fadeOut(600);
}

//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////





function validateRegistration()
{
	var sq1 		= $("#sq1").val();
	var sq2 		= $("#sq2").val();
	var an1 		= $("#answer1").val();
	var an2 		= $("#answer2").val();
	var has_error 	= false;
	var m 			= [];
	if (sq1 === sq2)
	{
		has_error = true;
		m.push("Duplicate Detected");
		m.push("You cannot select the same question");
	}
	else if (an1.length === 0)
	{
		has_error = true;
		m.push("Empty Field Detected");
		m.push("You must provide an answer to security question 1 to proceed");
	}
	else if (an2.length === 0)
	{
		has_error = true;
		m.push("Empty Field Detected");
		m.push("You must provide an answer to security question 2 to proceed");
	}
	if (has_error === true) { generateErrorWindow(m); }
	else 
	{ 
		var sq1 = $("#sq1").val();
		var sq2 = $("#sq2").val();
		$("#question1").val(sq1);
		$("#question2").val(sq2);
		$("#security_form").submit(); 
	}
}

function checkRegistrationFields()
{
	html = "";
    html += "<div class='su-center su-width30'>";
    html += "<div class='su-general'>";
    html += "<div class='su-closer-reg'><a href=\"javascript: closeError();\"><i class='fas fa-window-close su-err'></i></a></div>";
    html += "<div class='su-error-header'><i class='fas fa-exclamation-triangle'></i> <span id='su-error-header'>Message</span></div>";
    html += "<div class='err0' id='err0'>Are You Sure You Want To Logout?</div>";
    html += "<div class='err1' id='err1'>You have not completed registration and will be redirected to this page each time you login to the administration site</div>";
    html += "<div class='su-error-btns'>";
    html += "<button onClick=\"javascript: logout();\">Continue Logout</button>";
    html += "<button onClick=\"javascript: closeError();\">Complete Registration</button>";
    html += "</div>";
    html += "</div>";
    html += "</div>";
    $("#su-editor-builder").html(html);
    $("#su-editor-builder").hide();
    $("#su-editor-builder").removeClass('hidden');
    $("#su-editor-builder").fadeIn(600);
}
</script>

<div class='su-about-errors hidden' id='su-editor-builder'></div>

<div class="questionsH">
	<div>
		<div>Welcome to naturalwomansalon.com</div>
		<span>Please complete your registration to continue</span>
	</div>
	<div class="q_container">
		<form action="/adminAlta" method="POST" id="security_form">
			<input type="hidden" name="target_model" value="registration">
			<input type="hidden" name="sq1" id="question1" value="">
			<input type="hidden" name="sq2" id="question2" value="">
			<h3>Please select security questions from the lists below</h3>
			<h5>Security Question 1:</h5>
			<select id='sq1'>
				{% for q in questions %}
				<option value="{{q.question}}">{{q.question}}</option>
				{% endfor %}
			</select>
			<input type="text" name="answer1" id="answer1" placeholder="Security Answer 1">
			<div class='q_space'></div>

			<h5>Security Question 2:</h5>
			<select id="sq2">
				{% for q in questions %}
				<option value="{{q.question}}">{{q.question}}</option>
				{% endfor %}
			</select>
			<input type="text" name="answer2" id="answer2" placeholder="Security Answer 2">
			<div class='q_space'></div>

			<div class="q_container_btns">
				<button type="button" onClick="javascript: validateRegistration()">Submit</button>
				<button type="button" onClick="javascript: checkRegistrationFields();">Sign Out</button>
			</div>
		</form>
	</div>
</div>
{% endblock %}